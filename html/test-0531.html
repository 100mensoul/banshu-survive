<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦æœ¬ä¸å‹•ç”£ - ãƒ’ãƒ¡ãƒ¢ãƒªã®åœ°ãƒãƒƒãƒ—</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, #3498db, #2980b9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .map-container {
            position: relative;
            height: 80vh;
            margin: 2rem;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        #map {
            height: 100%;
            width: 100%;
        }

        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 250px;
        }

        .legend h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .legend-item:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateX(5px);
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .apartment { background: #e74c3c; }
        .tenant { background: #f39c12; }
        .land { background: #27ae60; }
        .development { background: #9b59b6; }

        .custom-popup .leaflet-popup-content-wrapper {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .custom-popup .leaflet-popup-content {
            margin: 20px;
            font-size: 14px;
            line-height: 1.6;
        }

        .custom-popup .leaflet-popup-tip {
            background: #667eea;
        }

        .popup-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 8px;
        }

        .popup-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 8px 0;
            font-weight: bold;
        }

        .status-active { background: #27ae60; }
        .status-planned { background: #f39c12; }
        .status-vacant { background: #95a5a6; }

        .popup-detail {
            margin: 8px 0;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .legend {
                position: relative;
                margin: 1rem;
                top: 0;
                right: 0;
            }
            
            .map-container {
                margin: 1rem;
                height: 70vh;
            }
            
            .header {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            z-index: 2000;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ç¦æœ¬ä¸å‹•ç”£ - ãƒ’ãƒ¡ãƒ¢ãƒªã®åœ°</h1>
        <p>å§«è·¯å¸‚èŠ±ç”°ç”º ä¸ŠåŸç”°ãƒ»é£¾æ±ãƒ»å°å·ã‚¨ãƒªã‚¢ã®ç‰©ä»¶ãƒãƒƒãƒ—</p>
    </div>

    <div class="map-container">
        <div class="loading" id="loading">ãƒãƒƒãƒ—ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
        <div id="map"></div>
        
        <div class="legend">
            <h3>ğŸ“ ç‰©ä»¶æƒ…å ±</h3>
            <div class="legend-item">
                <div class="legend-color apartment"></div>
                <span>ã‚¢ãƒ‘ãƒ¼ãƒˆ</span>
            </div>
            <div class="legend-item">
                <div class="legend-color tenant"></div>
                <span>ãƒ†ãƒŠãƒ³ãƒˆ</span>
            </div>
            <div class="legend-item">
                <div class="legend-color land"></div>
                <span>è¾²åœ°ãƒ»ç”°ã‚“ã¼</span>
            </div>
            <div class="legend-item">
                <div class="legend-color development"></div>
                <span>é–‹ç™ºäºˆå®šåœ°</span>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // åœ°å›³ã®åˆæœŸåŒ–ï¼ˆSimple CRSã‚’ä½¿ç”¨ã—ã¦ç‹¬è‡ªåº§æ¨™ç³»ã§ä½œæˆï¼‰
        const map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: 0,
            maxZoom: 4,
            center: [300, 400],
            zoom: 1,
            zoomControl: true,
            attributionControl: false
        });

        // èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’éè¡¨ç¤º
        setTimeout(function() {
            document.getElementById('loading').style.display = 'none';
        }, 500);

        // èƒŒæ™¯åœ°å›³ã®ä½œæˆï¼ˆSVGãƒ™ãƒ¼ã‚¹ï¼‰
        const mapBounds = [[0, 0], [600, 800]];
        
        // èƒŒæ™¯è‰²ã®è¨­å®š
        map.getContainer().style.background = '#f0f8ff';

        // é“è·¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆ
        const roads = [
            // çœŒé“372å·ç·šï¼ˆãƒ¡ã‚¤ãƒ³é“è·¯ï¼‰
            L.polyline([[250, 50], [250, 750]], {
                color: '#ffa500',
                weight: 8,
                opacity: 0.8
            }).bindTooltip('çœŒé“372å·ç·š', {permanent: false}),
            
            // ãã®ä»–ã®é“è·¯
            L.polyline([[100, 200], [500, 200]], {
                color: '#808080',
                weight: 4,
                opacity: 0.6
            }),
            L.polyline([[150, 100], [400, 400]], {
                color: '#808080',
                weight: 3,
                opacity: 0.6
            }),
            L.polyline([[300, 150], [600, 300]], {
                color: '#808080',
                weight: 3,
                opacity: 0.6
            })
        ];

        // æ²³å·ã®ä½œæˆ
        const rivers = [
            L.polyline([[200, 100], [300, 200], [400, 180], [500, 250]], {
                color: '#4a90e2',
                weight: 4,
                opacity: 0.7,
                dashArray: '5, 5'
            }).bindTooltip('å¤©å·', {permanent: false})
        ];

        // é“è·¯ã¨æ²³å·ã‚’ãƒãƒƒãƒ—ã«è¿½åŠ 
        roads.forEach(road => road.addTo(map));
        rivers.forEach(river => river.addTo(map));

        // ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿
        const properties = [
            {
                id: 1,
                name: 'ã‚¢ãƒ‘ãƒ¼ãƒˆ1ï¼ˆãƒ„ã‚¤ãƒ³ãƒ”ãƒ¼ã‚¯ã‚¹ï¼‰',
                type: 'apartment',
                position: [300, 200],
                status: 'planned',
                details: {
                    description: 'ç¦æœ¬è˜ã¨ç¦å¯¿è˜ã®2æ£Ÿã‹ã‚‰ãªã‚‹ã‚¢ãƒ‘ãƒ¼ãƒˆ',
                    residents: 'ç¾åœ¨2çµ„ãŒå±…ä½',
                    condition: 'è€æœ½åŒ–ãŒé€²ã‚“ã§ã„ã‚‹',
                    plan: 'æ”¹ç¯‰äºˆå®šï¼ˆå»ºç¯‰å£«ã¨è¨ˆç”»ä¸­ï¼‰',
                    priority: 'ç›®ä¸‹ã®ãƒ¡ã‚¤ãƒ³æ¨é€²ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
                }
            },
            {
                id: 2,
                name: 'ã‚¢ãƒ‘ãƒ¼ãƒˆ2ï¼ˆé‡è·¯èŠï¼‰',
                type: 'apartment',
                position: [200, 350],
                status: 'vacant',
                details: {
                    description: 'å…¥ã‚Šçµ„ã‚“ã å ´æ‰€ã«ã‚ã‚‹ã‚¢ãƒ‘ãƒ¼ãƒˆ',
                    condition: 'ç‰¹ã«æ´»ç”¨äºˆå®šãªã—',
                    location: 'ç«‹åœ°ãŒä¸ä¾¿'
                }
            },
            {
                id: 3,
                name: 'ãƒ†ãƒŠãƒ³ãƒˆ1ï¼ˆæ—§ã‚µãƒ ã‚¨ï¼‰',
                type: 'tenant',
                position: [350, 180],
                status: 'planned',
                details: {
                    description: 'ç¾åœ¨ç©ºããƒ†ãƒŠãƒ³ãƒˆ',
                    plan: 'æ–°è¦ã«ç¾å®¹é™¢ãŒå…¥å±…äºˆå®š',
                    status_detail: 'å¥‘ç´„æº–å‚™ä¸­'
                }
            },
            {
                id: 4,
                name: 'ãƒ†ãƒŠãƒ³ãƒˆ2ï¼ˆã‚¢ãƒ­ãƒ¼ãƒ ï¼‰',
                type: 'tenant',
                position: [280, 300],
                status: 'active',
                details: {
                    description: 'å°±åŠ´äº‹æ¥­æ‰€',
                    business: 'ãŠå¼å½“å±‹ã•ã‚“ã‚¢ãƒ­ãƒ¼ãƒ ',
                    operation: 'ç¾åœ¨å–¶æ¥­ä¸­'
                }
            },
            {
                id: 5,
                name: 'ä¸ŠåŸç”°åŒ—å´ã®åœŸåœ°',
                type: 'development',
                position: [400, 150],
                status: 'planned',
                details: {
                    description: 'çœŒé“372å·ç·šåŒ—å´ã€ä¸ŠåŸç”°äº¤å·®ç‚¹æ±å´',
                    current_use: 'ç”°ã‚“ã¼ï¼ˆè¾²æ¥­ç”¨åœ°ï¼‰',
                    situation: 'é–¢æ±ã®å·¥å ´ãŒæœ‰é¦¬ä¸å‹•ç”£ã¨äº¤æ¸‰ä¸­',
                    progress: '8-9å‰²è©±ãŒæ±ºã¾ã£ã¦ã„ã‚‹çŠ¶æ³',
                    note: 'ãƒ­ãƒ¼ã‚½ãƒ³ã®éš£ã®åœŸåœ°'
                }
            },
            {
                id: 6,
                name: 'ä¸ŠåŸç”°å—å´ã®åœŸåœ°',
                type: 'land',
                position: [400, 250],
                status: 'active',
                details: {
                    description: 'çœŒé“372å·ç·šå—å´ã®è¾²æ¥­ç”¨åœ°',
                    current_use: 'ç”°ã‚“ã¼ï¼ˆä»Šå¹´ã‚‚ç”°æ¤ãˆã‚’å®Ÿæ–½ï¼‰',
                    ownership: '13å®¶ã»ã©ãŒæ‰€æœ‰',
                    deal: '8å‰²ãŒè²¸ã—ã€2å‰²ãŒå£²ã‚Š',
                    negotiation: 'ãƒ€ã‚¤ãƒ¯ãƒã‚¦ã‚¹ã€äº¬éƒ½ã®ä¸å‹•ç”£ä¼šç¤¾ãŒäº¤æ¸‰ä¸­'
                }
            },
            {
                id: 7,
                name: 'é“ã®é§…å»ºè¨­äºˆå®šåœ°',
                type: 'development',
                position: [500, 200],
                status: 'planned',
                details: {
                    description: 'èŠ±ç”°ICæ±å´ã€å¤©å·æ²¿ã„ã®æ•·åœ°',
                    status_detail: 'å§«è·¯å¸‚ãŒåœŸåœ°ã‚’è³¼å…¥æ¸ˆã¿',
                    schedule: 'ä»¤å’Œ7å¹´7æœˆã«ãƒ—ãƒ­ãƒãƒ¼ã‚¶ãƒ«å—ä»˜é–‹å§‹äºˆå®š',
                    method: 'DBOæ–¹å¼ï¼ˆè¨­è¨ˆãƒ»å»ºç¯‰ãƒ»é‹å–¶ã‚’æ°‘é–“å§”è¨—ï¼‰',
                    features: 'è»Šä¸¡ä¼‘æ†©ã€è¾²ä½œç‰©è²©å£²ã€é˜²ç½æ‹ ç‚¹ã€å½¹æ‰€å‡ºå¼µæ©Ÿèƒ½'
                }
            }
        ];

        // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆ
        function createCustomIcon(type, status) {
            const colors = {
                apartment: '#e74c3c',
                tenant: '#f39c12',
                land: '#27ae60',
                development: '#9b59b6'
            };

            const icons = {
                apartment: 'ğŸ ',
                tenant: 'ğŸª',
                land: 'ğŸŒ¾',
                development: 'ğŸ—ï¸'
            };

            const borderColor = status === 'active' ? '#27ae60' : 
                               status === 'planned' ? '#f39c12' : '#95a5a6';

            return L.divIcon({
                html: `
                    <div style="
                        background: ${colors[type]};
                        width: 35px;
                        height: 35px;
                        border-radius: 50%;
                        border: 3px solid ${borderColor};
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 16px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    ">${icons[type]}</div>
                `,
                className: 'custom-marker',
                iconSize: [35, 35],
                iconAnchor: [17, 17]
            });
        }

        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä½œæˆ
        function createPopupContent(property) {
            const statusMap = {
                active: { text: 'é‹å–¶ä¸­', class: 'status-active' },
                planned: { text: 'è¨ˆç”»ä¸­', class: 'status-planned' },
                vacant: { text: 'ç©ºå®¤', class: 'status-vacant' }
            };

            const status = statusMap[property.status];
            
            let detailsHtml = '';
            Object.entries(property.details).forEach(([key, value]) => {
                const labelMap = {
                    description: 'æ¦‚è¦',
                    residents: 'å±…ä½çŠ¶æ³',
                    condition: 'çŠ¶æ…‹',
                    plan: 'è¨ˆç”»',
                    priority: 'å„ªå…ˆåº¦',
                    business: 'äº‹æ¥­å†…å®¹',
                    operation: 'é‹å–¶çŠ¶æ³',
                    current_use: 'ç¾åœ¨ã®ç”¨é€”',
                    situation: 'çŠ¶æ³',
                    progress: 'é€²æ—',
                    note: 'å‚™è€ƒ',
                    ownership: 'æ‰€æœ‰çŠ¶æ³',
                    deal: 'å–å¼•å½¢æ…‹',
                    negotiation: 'äº¤æ¸‰çŠ¶æ³',
                    status_detail: 'è©³ç´°',
                    schedule: 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«',
                    method: 'å®Ÿæ–½æ–¹å¼',
                    features: 'æ©Ÿèƒ½',
                    location: 'ç«‹åœ°'
                };

                const label = labelMap[key] || key;
                detailsHtml += `
                    <div class="popup-detail">
                        <strong>${label}:</strong> ${value}
                    </div>
                `;
            });

            return `
                <div class="popup-title">${property.name}</div>
                <div class="popup-status ${status.class}">${status.text}</div>
                ${detailsHtml}
            `;
        }

        // ãƒãƒ¼ã‚«ãƒ¼ã®ä½œæˆã¨è¿½åŠ 
        properties.forEach(property => {
            const marker = L.marker(property.position, {
                icon: createCustomIcon(property.type, property.status)
            }).addTo(map);

            marker.bindPopup(createPopupContent(property), {
                maxWidth: 350,
                className: 'custom-popup'
            });

            // ãƒ›ãƒãƒ¼åŠ¹æœ
            marker.on('mouseover', function() {
                this.getElement().style.transform = 'scale(1.2)';
                this.getElement().style.zIndex = '1000';
            });

            marker.on('mouseout', function() {
                this.getElement().style.transform = 'scale(1)';
                this.getElement().style.zIndex = '100';
            });
        });

        // åœ°å›³ã®ç¯„å›²ã‚’è¨­å®š
        map.fitBounds([[50, 50], [550, 750]]);

        // åœ°å›³ã«ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¿½åŠ 
        const titleControl = L.control({position: 'topleft'});
        titleControl.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'map-title');
            div.innerHTML = `
                <div style="
                    background: rgba(255,255,255,0.9);
                    padding: 10px 15px;
                    border-radius: 10px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    font-weight: bold;
                    color: #2c3e50;
                ">
                    ğŸ—ºï¸ ãƒ’ãƒ¡ãƒ¢ãƒªã®åœ° - ç¦æœ¬ä¸å‹•ç”£ãƒãƒƒãƒ—
                </div>
            `;
            return div;
        };
        titleControl.addTo(map);

        // æƒ…å ±ãƒ‘ãƒãƒ«ã®è¿½åŠ 
        const infoControl = L.control({position: 'bottomleft'});
        infoControl.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'info-panel');
            div.innerHTML = `
                <div style="
                    background: rgba(255,255,255,0.95);
                    padding: 15px;
                    border-radius: 10px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    max-width: 300px;
                    font-size: 12px;
                    line-height: 1.4;
                ">
                    <strong>ğŸ“ ãƒãƒƒãƒ—ã®ä½¿ã„æ–¹</strong><br>
                    â€¢ ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°è¡¨ç¤º<br>
                    â€¢ ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã‚ºãƒ¼ãƒ <br>
                    â€¢ ãƒ‰ãƒ©ãƒƒã‚°ã§åœ°å›³ç§»å‹•<br>
                    <br>
                    <strong>ğŸ—ï¸ ä¸»è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</strong><br>
                    â€¢ ãƒ„ã‚¤ãƒ³ãƒ”ãƒ¼ã‚¯ã‚¹æ”¹ç¯‰è¨ˆç”»<br>
                    â€¢ é“ã®é§…å»ºè¨­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ<br>
                    â€¢ ä¸ŠåŸç”°åœŸåœ°é–‹ç™º
                </div>
            `;
            return div;
        };
        infoControl.addTo(map);

        console.log('ç¦æœ¬ä¸å‹•ç”£ãƒãƒƒãƒ—ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
    </script>
</body>
</html>
