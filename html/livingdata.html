<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>播州ロケーションインサイト</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .search-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .filter-group select,
        .filter-group input {
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #495057;
            border: 2px solid #dee2e6;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .view-toggle {
            display: flex;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 4px;
        }

        .view-toggle button {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-toggle button.active {
            background: #667eea;
            color: white;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .card-type {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .card-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 3px;
        }

        .info-value {
            font-weight: 600;
            color: #2c3e50;
        }

        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e1e8ed;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .checkbox {
            position: absolute;
            top: 15px;
            left: 15px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .detail-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .detail-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stats {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .search-filters {
                grid-template-columns: 1fr;
            }
            
            .gallery {
                grid-template-columns: 1fr;
            }
            
            .card-info {
                grid-template-columns: 1fr;
            }
            
            .detail-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>播州ロケーションインサイト</h1>
            <p>上原田エリアの詳細データベース - 持続可能なまちづくりのために</p>
        </div>

        <div class="stats">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalSpots">14</div>
                    <div class="stat-label">総スポット数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="storeCount">9</div>
                    <div class="stat-label">店舗</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="vacantCount">2</div>
                    <div class="stat-label">空き地</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="selectedCount">0</div>
                    <div class="stat-label">選択中</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="search-filters">
                <div class="filter-group">
                    <label for="typeFilter">種別</label>
                    <select id="typeFilter">
                        <option value="">すべて</option>
                        <option value="store">店舗</option>
                        <option value="vacant">空き地</option>
                        <option value="residential">住宅</option>
                        <option value="agriculture">農地</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="areaFilter">面積（m²）</label>
                    <select id="areaFilter">
                        <option value="">すべて</option>
                        <option value="0-1000">1,000m²未満</option>
                        <option value="1000-5000">1,000-5,000m²</option>
                        <option value="5000+">5,000m²以上</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="distanceFilter">姫路駅からの距離</label>
                    <select id="distanceFilter">
                        <option value="">すべて</option>
                        <option value="0-15">15分以内</option>
                        <option value="15-30">15-30分</option>
                        <option value="30+">30分以上</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="searchInput">キーワード検索</label>
                    <input type="text" id="searchInput" placeholder="施設名、住所で検索">
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="exportSelected()">選択項目をCSV出力</button>
                <button class="btn btn-secondary" onclick="clearSelection()">選択解除</button>
                <div class="view-toggle">
                    <button class="active" onclick="setView('gallery')">ギャラリー</button>
                    <button onclick="setView('list')">リスト</button>
                </div>
            </div>
        </div>

        <div class="gallery" id="gallery">
            <!-- カードはJavaScriptで動的生成 -->
        </div>
    </div>

    <!-- モーダル -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">詳細情報</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div id="modalBody">
                <!-- 詳細情報はJavaScriptで動的生成 -->
            </div>
        </div>
    </div>

    <script>
        // サンプルデータ
        const locationData = [
            {
                id: 1,
                name: "ヤマダデンキ",
                type: "store",
                category: "家電量販店",
                address: "兵庫県姫路市花田町上原田",
                area: 2800,
                zoning: "商業地域",
                status: "営業中",
                revenue: "高",
                accessibility: {
                    himejiStation: 18,
                    hanedaIC: 5,
                    sanyoHimejiIC: 12
                },
                infrastructure: {
                    water: "整備済み",
                    electricity: "整備済み",
                    gas: "整備済み",
                    internet: "光ファイバー対応"
                }
            },
            {
                id: 2,
                name: "エディオン",
                type: "store",
                category: "家電量販店",
                address: "兵庫県姫路市花田町上原田",
                area: 2400,
                zoning: "商業地域",
                status: "営業中",
                revenue: "中",
                accessibility: {
                    himejiStation: 19,
                    hanedaIC: 6,
                    sanyoHimejiIC: 13
                },
                infrastructure: {
                    water: "整備済み",
                    electricity: "整備済み",
                    gas: "整備済み",
                    internet: "光ファイバー対応"
                }
            },
            {
                id: 3,
                name: "空き地（有馬不動産購入地）",
                type: "vacant",
                category: "開発用地",
                address: "兵庫県姫路市花田町上原田南側",
                area: 8500,
                zoning: "市街化調整区域",
                status: "空地",
                revenue: "-",
                accessibility: {
                    himejiStation: 16,
                    hanedaIC: 3,
                    sanyoHimejiIC: 10
                },
                infrastructure: {
                    water: "接続可能",
                    electricity: "接続可能",
                    gas: "接続要工事",
                    internet: "光ファイバー対応"
                }
            },
            {
                id: 4,
                name: "道の駅（候補地）",
                type: "vacant",
                category: "公共施設候補",
                address: "兵庫県姫路市花田町上原田",
                area: 5200,
                zoning: "市街化調整区域",
                status: "計画中",
                revenue: "-",
                accessibility: {
                    himejiStation: 17,
                    hanedaIC: 4,
                    sanyoHimejiIC: 11
                },
                infrastructure: {
                    water: "整備要",
                    electricity: "接続可能",
                    gas: "接続要工事",
                    internet: "光ファイバー対応"
                }
            },
            {
                id: 5,
                name: "マクドナルド",
                type: "store",
                category: "飲食店",
                address: "兵庫県姫路市花田町上原田",
                area: 800,
                zoning: "商業地域",
                status: "営業中",
                revenue: "高",
                accessibility: {
                    himejiStation: 18,
                    hanedaIC: 5,
                    sanyoHimejiIC: 12
                },
                infrastructure: {
                    water: "整備済み",
                    electricity: "整備済み",
                    gas: "整備済み",
                    internet: "光ファイバー対応"
                }
            }
        ];

        let filteredData = [...locationData];
        let selectedItems = new Set();

        // ページ初期化
        function init() {
            renderGallery();
            setupEventListeners();
        }

        // イベントリスナー設定
        function setupEventListeners() {
            document.getElementById('typeFilter').addEventListener('change', applyFilters);
            document.getElementById('areaFilter').addEventListener('change', applyFilters);
            document.getElementById('distanceFilter').addEventListener('change', applyFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
        }

        // ギャラリー表示
        function renderGallery() {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';

            filteredData.forEach(item => {
                const card = createCard(item);
                gallery.appendChild(card);
            });

            updateStats();
        }

        // カード作成
        function createCard(item) {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <input type="checkbox" class="checkbox" onchange="toggleSelection(${item.id})" ${selectedItems.has(item.id) ? 'checked' : ''}>
                <div class="card-header">
                    <div>
                        <div class="card-title">${item.name}</div>
                        <div class="info-label">${item.address}</div>
                    </div>
                    <div class="card-type">${item.category}</div>
                </div>
                <div class="card-info">
                    <div class="info-item">
                        <div class="info-label">面積</div>
                        <div class="info-value">${item.area.toLocaleString()}m²</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">区分</div>
                        <div class="info-value">${item.zoning}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">姫路駅まで</div>
                        <div class="info-value">車で${item.accessibility.himejiStation}分</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">状態</div>
                        <div class="info-value">${item.status}</div>
                    </div>
                </div>
                <div class="card-actions">
                    <button class="btn btn-primary btn-small" onclick="showDetail(${item.id})">詳細を見る</button>
                    <button class="btn btn-secondary btn-small" onclick="showOnMap(${item.id})">地図で見る</button>
                </div>
            `;
            return card;
        }

        // フィルター適用
        function applyFilters() {
            const typeFilter = document.getElementById('typeFilter').value;
            const areaFilter = document.getElementById('areaFilter').value;
            const distanceFilter = document.getElementById('distanceFilter').value;
            const searchText = document.getElementById('searchInput').value.toLowerCase();

            filteredData = locationData.filter(item => {
                // 種別フィルター
                if (typeFilter && item.type !== typeFilter) return false;

                // 面積フィルター
                if (areaFilter) {
                    const [min, max] = areaFilter.split('-').map(v => v === '+' ? Infinity : parseInt(v) || 0);
                    if (item.area < min || (max !== Infinity && item.area >= max)) return false;
                }

                // 距離フィルター
                if (distanceFilter) {
                    const [min, max] = distanceFilter.split('-').map(v => v === '+' ? Infinity : parseInt(v) || 0);
                    if (item.accessibility.himejiStation < min || 
                        (max !== Infinity && item.accessibility.himejiStation >= max)) return false;
                }

                // キーワード検索
                if (searchText) {
                    const searchableText = `${item.name} ${item.address} ${item.category}`.toLowerCase();
                    if (!searchableText.includes(searchText)) return false;
                }

                return true;
            });

            renderGallery();
        }

        // アイテム選択切り替え
        function toggleSelection(id) {
            if (selectedItems.has(id)) {
                selectedItems.delete(id);
            } else {
                selectedItems.add(id);
            }
            updateStats();
        }

        // 統計情報更新
        function updateStats() {
            document.getElementById('totalSpots').textContent = filteredData.length;
            document.getElementById('storeCount').textContent = filteredData.filter(item => item.type === 'store').length;
            document.getElementById('vacantCount').textContent = filteredData.filter(item => item.type === 'vacant').length;
            document.getElementById('selectedCount').textContent = selectedItems.size;
        }

        // 詳細表示
        function showDetail(id) {
            const item = locationData.find(item => item.id === id);
            if (!item) return;

            document.getElementById('modalTitle').textContent = item.name;
            document.getElementById('modalBody').innerHTML = `
                <div class="detail-grid">
                    <div class="detail-section">
                        <h3>基本情報</h3>
                        <div class="info-item">
                            <div class="info-label">種別</div>
                            <div class="info-value">${item.category}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">住所</div>
                            <div class="info-value">${item.address}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">面積</div>
                            <div class="info-value">${item.area.toLocaleString()}m²</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">区分</div>
                            <div class="info-value">${item.zoning}</div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>アクセス</h3>
                        <div class="info-item">
                            <div class="info-label">JR姫路駅まで</div>
                            <div class="info-value">車で${item.accessibility.himejiStation}分</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">花田ICまで</div>
                            <div class="info-value">車で${item.accessibility.hanedaIC}分</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">山陽姫路ICまで</div>
                            <div class="info-value">車で${item.accessibility.sanyoHimejiIC}分</div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>インフラ</h3>
                        <div class="info-item">
                            <div class="info-label">上下水道</div>
                            <div class="info-value">${item.infrastructure.water}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">電力</div>
                            <div class="info-value">${item.infrastructure.electricity}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ガス</div>
                            <div class="info-value">${item.infrastructure.gas}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">通信</div>
                            <div class="info-value">${item.infrastructure.internet}</div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>運営状況</h3>
                        <div class="info-item">
                            <div class="info-label">状態</div>
                            <div class="info-value">${item.status}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">収益性</div>
                            <div class="info-value">${item.revenue}</div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('detailModal').style.display = 'block';
        }

        // モーダル閉じる
        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // 地図で表示
        function showOnMap(id) {
            // 既存のマップページに遷移
            window.open(`zoom-map-4.html#spot-${id}`, '_blank');
        }

        // CSV出力
        function exportSelected() {
            if (selectedItems.size === 0) {
                alert('エクスポートする項目を選択してください。');
                return;
            }

            const selectedData = locationData.filter(item => selectedItems.has(item.id));
            const csvContent = convertToCSV(selectedData);
            downloadCSV(csvContent, '播州ロケーションデータ.csv');
        }

        // CSV変換
        function convertToCSV(data) {
            const headers = [
                '名称', '種別', 'カテゴリ', '住所', '面積(m²)', '区分', '状態',
                '姫路駅まで(分)', '花田ICまで(分)', '山陽姫路ICまで(分)',
                '上下水道', '電力', 'ガス', '通信'
            ];

            const rows = data.map(item => [
                item.name,
                item.type,
                item.category,
                item.address,
                item.area,
                item.zoning,
                item.status,
                item.accessibility.himejiStation,
                item.accessibility.hanedaIC,
                item.accessibility.sanyoHimejiIC,
                item.infrastructure.water,
                item.infrastructure.electricity,
                item.infrastructure.gas,
                item.infrastructure.internet
            ]);

            return [headers, ...rows].map(row => 
                row.map(field => `"${field}"`).join(',')
            ).join('\n');
        }

        // CSVダウンロード
        function downloadCSV(content, filename) {
            const blob = new Blob(['\uFEFF' + content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // 選択解除
        function clearSelection() {
            selectedItems.clear();
            const checkboxes = document.querySelectorAll('.checkbox');
            checkboxes.forEach(cb => cb.checked = false);
            updateStats();
        }

        // 表示切り替え
        function setView(viewType) {
            const buttons = document.querySelectorAll('.view-toggle button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // ここで実際の表示切り替えを実装
            if (viewType === 'list') {
                // リスト表示の実装
                console.log('リスト表示に切り替え');
            } else {
                // ギャラリー表示の実装
                console.log('ギャラリー表示に切り替え');
            }
        }

        // ページロード時の初期化
        document.addEventListener('DOMContentLoaded', init);

        // モーダル外クリックで閉じる
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        });
    </script>
</body>
</html>
